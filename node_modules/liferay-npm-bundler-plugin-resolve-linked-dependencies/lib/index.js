"use strict";
/**
 * SPDX-FileCopyrightText: Â© 2017 Liferay, Inc. <https://liferay.com>
 * SPDX-License-Identifier: LGPL-3.0-or-later
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = __importDefault(require("path"));
const read_json_sync_1 = __importDefault(require("read-json-sync"));
const semver_1 = __importDefault(require("semver"));
/**
 * @return {void}
 */
function default_1({ log }, { pkgJson }) {
    if (pkgJson.dependencies !== null && pkgJson.dependencies !== undefined) {
        Object.keys(pkgJson.dependencies).forEach((name) => {
            const link = pkgJson.dependencies[name];
            if (semver_1.default.validRange(link) === null ||
                semver_1.default.validRange(link) === undefined) {
                const depPkgJsonPath = path_1.default.join('node_modules', name, 'package.json');
                const depPkgJson = read_json_sync_1.default(depPkgJsonPath);
                pkgJson.dependencies[name] = depPkgJson.version;
                log.info('resolve-linked-dependencies', 'Resolved link', link, 'to', depPkgJson.version);
            }
        });
    }
}
exports.default = default_1;
